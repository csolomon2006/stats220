---
title: Interesting data about Coffee
author: Christian Solomon
output: html_document
---

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)
```

```{js}
$(function() {
  $(".level2").css('visibility', 'hidden');
  $(".level2").first().css('visibility', 'visible');
  $(".container-fluid").height($(".container-fluid").height() + 300);
  $(window).on('scroll', function() {
    $('h2').each(function() {
      var h2Top = $(this).offset().top - $(window).scrollTop();
      var windowHeight = $(window).height();
      if (h2Top >= 0 && h2Top <= windowHeight / 2) {
        $(this).parent('div').css('visibility', 'visible');
      } else if (h2Top > windowHeight / 2) {
        $(this).parent('div').css('visibility', 'hidden');
      }
    });
  });
})
```

```{css echo=FALSE}
.figcaption {display: none}
body {
    font-family: 'Poppins', sans-serif;
    background-color: #f5ebe0;
    color: #3e2723;
    margin: 40px;
}

h1 {
    color: #4e342e;
    text-align: center;
}

p {
    font-size: 16px;
    line-height: 1.6;
}
```
```{r}
library(tidyverse)
library(stringr)

logged_data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vRZFQTrRxt4zgYvwvtUPg0XRgOA1KKS72fAdcsh_CzGsppoDe7eHIM9qypNXo9bOnnO357OGC6r2UsN/pub?output=csv")

plot1 <- ggplot(data = logged_data) +
  geom_bar(aes(x = `What coffee was ordered?`), fill = "chocolate") +
  labs(
    title = "What was the most ordered coffee?", 
    x = "Coffees",
    y = "Number of orders") +
  theme_minimal()

avg_time_per_coffee <- logged_data %>%
  group_by(`What coffee was ordered?`) %>%
  summarise(avg_time = mean(`How long did it take the barista to make this coffee?`, na.rm = TRUE)) %>%
  arrange(desc(avg_time))

plot2 <- ggplot(avg_time_per_coffee, aes(x = `What coffee was ordered?`, y = avg_time)) +
  geom_bar(stat = "identity", fill = "darkgreen") +
  labs(
    title = "Which coffee is made the fastest?",
    x = "Coffees",
    y = "Time taken (in minutes)"
  )



extras_by_coffee <- logged_data %>%
  filter(!is.na(`Were additional items ordered?`)) %>%
  mutate(extra_ordered = str_detect(`Were additional items ordered?`, regex("yes", ignore_case = TRUE))) %>%
  group_by(`What coffee was ordered?`) %>%
  summarise(extra_items_count = sum(extra_ordered, na.rm = TRUE),
            total_orders = n(),
            proportion_with_extras = extra_items_count / total_orders) %>%
  arrange(desc(extra_items_count))

plot3 <- ggplot(extras_by_coffee, aes(x = reorder(`What coffee was ordered?`, extra_items_count), y = extra_items_count)) +
  geom_col(fill = "darkorchid") +
  labs(
    title = "Coffee Types with Most Extra Items Ordered",
    x = "Coffee Type",
    y = "Number of Orders with Extras"
  ) +
  coord_flip() +
  theme_minimal()

ggsave("plot1.png", plot = plot1)
ggsave("plot2.png", plot = plot2)
ggsave("plot3.png", plot = plot3)

```

I was curious about what the most common coffee orders were, which coffee takes the longest to make, and the coffee that gets the most extra items ordered. The graphs below show interesting information about peoples coffee orders.  



## This graph shows the most ordered coffees

We can see that the latte was the most ordered coffee with there being 8 orders, whilst the least ordered coffees were the Iced Latte and the Macchiato.

![](plot1.png)

## This graph shows which coffee was made the quickest 

We see that the coffee made the quickest was the espresso at 2 minutes whilst the coffees that took the longest were the Iced Latte and the Mocha.
![](plot2.png)

## This graph shows which coffees had the most extra items ordered

We see that the coffee with the most extra items ordered was the Latte whilst the Espresso and the Black Coffee did not have any extra items ordered.
![](plot3.png)

